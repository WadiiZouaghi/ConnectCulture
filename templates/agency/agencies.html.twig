{% extends 'baseAA.html.twig' %}

{% block title %}Agencies{% endblock %}

{% block body %}
<section class="agencies-section">
    <!-- System Info Bar -->
    


    <div class="agencies-container">
        <!-- Agencies Header -->
        <div class="agencies-header">
            <div class="heading_container">
                <h2>Agency <span>List</span></h2>
            </div>
        </div>
        <!-- Search and Sort Container -->
        <div class="search-sort-container">
            <!-- Search Form -->
            <div class="search-container">
                <form method="GET" action="{{ path('agency_list') }}">
                    <input type="text" name="search" placeholder="Search by Agency Name" value="{{ app.request.query.get('search') }}">
                    <button type="submit"><i class="fa fa-search"></i></button>
                </form>
            </div>

            <!-- Sort by Name -->
            <div class="sort-container">
                <select onchange="window.location.href = this.value;">
                    <option value="{{ path('agency_list', {'search': app.request.query.get('search'), 'sort': 'asc'}) }}" {% if app.request.query.get('sort') == 'asc' %}selected{% endif %}>Sort by Name (Asc) <i class="fa fa-sort-up"></i></option>
                    <option value="{{ path('agency_list', {'search': app.request.query.get('search'), 'sort': 'desc'}) }}" {% if app.request.query.get('sort') == 'desc' %}selected{% endif %}>Sort by Name (Desc) <i class="fa fa-sort-down"></i></option>
                </select>
            </div>
        </div>


        <!-- Agencies Table -->
        <div class="agencies-table">
            {% if agencies is empty %}
                <div class="no-agencies">
                    <i class="fa fa-building-o"></i>
                    <h3>No Agencies Found</h3>
                    
                </div>
            {% else %}
                <table class="table">
                    <thead>
                        <tr>
                            <th>Agency Name</th>
                            <th>description</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for agency in agencies %}
                            <tr>
                                <td>{{ agency.name }}</td>
                                <td>{{ agency.address.description }}</td>
                                <td>
                                    <a href="{{ path('agency_get_agency', {'id': agency.getAgencyId()}) }}" class="action-btn view-btn">
                                        <i class="fa fa-eye"></i> View
                                     </a>


                                    <a href="#" onclick="event.preventDefault(); if(confirm('Are you sure you want to delete this agency?')) document.getElementById('delete-form-{{ agency.getAgencyId() }}').submit();" class="action-btn delete-btn">
                                        <i class="fa fa-trash"></i>
                                        Delete
                                    </a>

                                    <a href="#" onclick="document.getElementById('collaborate-form-{{ agency.getAgencyId() }}').style.display = 'block';" class="action-btn collaborate-btn">
                                        <i class="fa fa-envelope"></i>
                                        Collaborate
                                    </a>

                                    <!-- Collaborate Form (hidden by default) -->
                                    <div id="collaborate-form-{{ agency.getAgencyId() }}" style="display: none;">
                                        <form action="{{ path('agency_agency_collaborate', {'id': agency.getAgencyId()}) }}" method="POST">
                                            <input type="hidden" name="agency_email" value="{{ agency.email }}">
                                            <input type="text" name="subject" placeholder="Subject" required>
                                            <textarea name="message" rows="4" cols="50" placeholder="Write your message here..." required></textarea>
                                            <button type="submit" class="action-btn send-btn">Send</button>
                                        </form>
                                    </div>

                                </td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            {% endif %}
        </div>
    </div>
</section>
<style>
/* Container for Search and Sort */
.search-sort-container {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 20px;
    margin-bottom: 20px;
}

/* Search Input */
.search-container form {
    display: flex;
    align-items: center;
}

.search-container input {
    padding: 10px;
    font-size: 16px;
    border: 1px solid #ccc;
    border-radius: 5px;
    width: 250px;
}

.search-container button {
    background-color: #007bff;
    color: white;
    border: none;
    padding: 10px;
    border-radius: 5px;
    cursor: pointer;
    margin-left: 10px;
}

.search-container button i {
    font-size: 18px;
}

/* Sort Dropdown */
.sort-container select {
    padding: 10px;
    font-size: 16px;
    border: 1px solid #ccc;
    border-radius: 5px;
    cursor: pointer;
    background-color: #f8f9fa;
}

.sort-container select option {
    padding: 10px;
}

/* Style the arrows inside the options */
.sort-container select i {
    margin-left: 5px;
}

.events-section {
    background-color: #f8f9fa;
    min-height: 100vh;
    padding: 20px;
}

.system-info-bar {
    background: #ffffff;
    padding: 15px 20px;
    border-radius: 4px;
    margin-bottom: 20px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
}

.system-info-item {
    color: #062264;
    font-family: monospace;
    font-size: 0.9rem;
    margin-bottom: 5px;
}

.events-container {
    max-width: 1200px;
    margin: 0 auto;
}

.events-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 30px;
}

.heading_container h2 {
    color: #062264;
    font-size: 1.8rem;
    margin: 0;
}

.heading_container span {
    color: #4b93d1;
}

.events-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 20px;
}

.event-card {
    background: #ffffff;
    border-radius: 4px;
    overflow: hidden;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
    transition: transform 0.3s;
}

.event-card:hover {
    transform: translateY(-5px);
}

.img-box {
    position: relative;
    height: 200px;
    overflow: hidden;
}

.img-box img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.no-image {
    height: 100%;
    background: #f8f9fa;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    color: #062264;
}

.no-image i {
    font-size: 48px;
    margin-bottom: 10px;
}

.event-type-badge {
    position: absolute;
    top: 10px;
    right: 10px;
    background: #4b93d1;
    color: #ffffff;
    padding: 5px 10px;
    border-radius: 4px;
}

.event-content {
    padding: 20px;
}

.event-info {
    margin-bottom: 20px;
}

.info-item {
    display: flex;
    align-items: start;
    margin-bottom: 15px;
    padding: 10px;
    transition: transform 0.3s;
}

.info-item i {
    margin-right: 10px;
    color: #4b93d1;
}

.info-content label {
    display: block;
    font-weight: 600;
    margin-bottom: 5px;
    color: #062264;
}

.info-content p {
    margin: 0;
    color: #666;
}

.description {
    max-height: 60px;
    overflow: hidden;
}

.event-actions {
    display: flex;
    gap: 10px;
    padding-top: 15px;
    border-top: 1px solid #eee;
}

.no-events {
    grid-column: 1 / -1;
    text-align: center;
    padding: 40px;
    background: #ffffff;
    border-radius: 4px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
}

.no-events i {
    font-size: 48px;
    color: #062264;
    margin-bottom: 15px;
}

.no-events h3 {
    color: #062264;
    margin-bottom: 10px;
}

@media (max-width: 768px) {
    .events-header {
        flex-direction: column;
        gap: 15px;
    }

    .event-actions {
        flex-direction: column;
    }

    .system-info-bar {
        padding: 10px;
    }
}
</style>
{% endblock %}
